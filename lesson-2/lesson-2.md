# Урок 2. Парсинг HTML. BeautifulSoup, MongoDB

Ключевые моменты
* Скрапинг сайта.
* на hh нужно быть сеньером, чтобы понять как генерируется динамическая состовляющая.
* 20 генерируется статично и 30 оставшихся скриптом.
## Структура HTML

<tag></tag> - в нашей работе мы будем
опираться названия тегов.

attr="" id - уникальный объект на странице 
class:
- визуальное оформление. идея: если есть повторяющиеся блоки, то они могут иметь одинаковые классы.
- логического объединения или задание структуры.
У одного тега может быть несколько классов.
идея: gb использует БЭМ.

## DOM - Document Object Model

способ взаимодействия с элементами на странице.

объект в доме = node

## Практика

```python
import requests
from bs4 import BeautifulSoup
from pprint import pprint

response = requests.get('')
dom = BeautifulSoup(response.text, 'html.parser')

tag_a = dom.find('a')  # первый тег а вернется.
pprint(tag_a) # возвращается с дочерними объектами

children_div = parent_a.children
# есть дополнительные дети '\n'
findChildren(recursive=False)
```

идея опрашивать еще раз через find дольше чем добраться nextsublink, если объекты находятся ближе.
свойства:
* `.parent`
* `children`
* `findChildren(recursive=False)`

### Поиск элементов по их атрибутам

```python
dom.find('div', attrs={'id: 'd2'})
dom.find('div', {'id: 'd2'})

dom.findAll('div', {'class': ['paragraph', 'red']}) # два класса
dom.select('p.red.paragraph')

dom.find(text='Шестой параграф')
```

`find` - останавливается на первом вхождении
`findAll` - находит все.

с атрибутом класс специфическая работа beautifulsoup.
Несмотря на то что суп знает, что внутри класса может быть несколько значений.
Поэтому если мы укажем через пробел, то он будет точно искать по содержимому класса.
Гибко искать можно двумя способами:
* список
* css-селектор

### Как выдрать данные из скрипта

* найти данные в скрипте
* воспользоваться selenium-ом.

## Практика кинопоиск

* `div.find('p')`
* `url + link.get('href')`
* можно дозаписывать в режиме отладки.
* nextSibling(может быть пустой элемент, а не нужный нам) or findAll()[2]

2Ж08

совет, использовать трай иксепт и брейкпойнт
ничего страшного если скраппер соберет по 20 всего 800
